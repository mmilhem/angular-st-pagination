angular.module("stPagination",[]),angular.module("stPagination").service("Pagination",["indexUtil",function(a){function b(a){this.$inputCollection=a,this.$limit=10,this.$page=0,this.$cachedReducedIndices={}}function c(a){return a&&a.pagination instanceof b}return b.hasPagination=c,angular.extend(b.prototype,{setInputCollection:function(a){this.$inputCollection=a,this.checkPageLimits()},paginatedInputCollection:function(){return this.$inputCollection.slice(this.start(),this.stop())},inputCollection:function(){return this.$inputCollection},start:function(){return this.offset()},stop:function(){return this.offset()+this.limit()},length:function(){return this.$inputCollection.length},setLimit:function(a){this.$limit=a},totalPages:function(){return Math.ceil(this.$inputCollection.length/this.limit())||1},offset:function(){return this.$page*this.$limit},page:function(){return this.$page},next:function(){this.$page+=1,this.checkPageLimits()},prev:function(){this.$page-=1,this.checkPageLimits()},limit:function(){return this.$limit},setPage:function(a){if(angular.isArray(a)){var b=Math.floor(a.length/2);this.$page=a[b]}else this.$page=a;this.checkPageLimits()},checkPageLimits:function(){this.$page<0?this.$page=0:this.$page>this.lastPage()&&(this.$page=this.lastPage())},displayPage:function(){return this.page()+1},onFirstPage:function(){return 0===this.page()},onLastPage:function(){return this.page()===this.lastPage()},onPage:function(a){return this.page()===a},lastPage:function(){return this.totalPages()-1},indices:function(){return a.range(this.totalPages())},reducedIndices:function(){var b=3,c=this.indexCacheKey(b);if(this.$cachedReducedIndices[c])return this.$cachedReducedIndices[c];var d=this.page(),e=a.rangeBuilder(this.totalPages()).foldFixedLengthForIndex(d,b).build();return this.$cachedReducedIndices[c]=e,e},indexCacheKey:function(a){return this.page()+"-"+this.limit()+"-"+this.length()+"-"+a},isIndex:function(a){return angular.isNumber(a)}}),b}]),angular.module("stPagination").filter("pagination",["Pagination","findPropertyName",function(a,b){return function(c,d){var e;if(c){if(e=d?d:c,!a.hasPagination(e)&&(e.pagination=new a(c),this&&this.$watch)){var f=b(e,this);if(!f)throw new Error("Collection passed to pagination filter was not found in the scope. Pass it to the filter if you have other filters in between.\nelement in collection | orderBy:'id' | pagination:collection");this.$watch(f,function(b,c){a.hasPagination(c)&&(b.pagination=c.pagination)})}var g=e.pagination;return g.setInputCollection(c),g.paginatedInputCollection()}}}]),angular.module("stPagination").factory("findPropertyName",function(){function a(b,c){try{angular.isObject(c)&&angular.forEach(c,function(d,e){if(d!==c&&("$"!==e[0]||"$parent"===e)){if(d===b)throw e;var f=a(b,c[e]);if(f)throw e+"."+f}})}catch(d){return d}}return a}),angular.module("stPagination").factory("indexUtil",function(){function a(a){this.array=a,this.lastIndex=a.length-1}function b(a){return Array.apply(null,new Array(a)).map(function(a,b){return b})}function c(c){return new a(b(c))}return angular.extend(a.prototype,{build:function(){return this.array},foldGreaterThan:function(a){return this.foldRange(a+1,this.lastIndex)},foldGreaterEquals:function(a){return this.foldRange(a,this.lastIndex)},foldLessThan:function(a){return this.foldRange(0,a-1)},foldLessEquals:function(a){return this.foldRange(0,a)},foldRange:function(a,b){var c=this.array,d=this.array=[];return c.forEach(function(c){if(a>c||c>b||angular.isArray(c))d.push(c);else{var e=d[d.length-1];angular.isArray(e)?e.push(c):d.push([c])}}),this},foldFixedLengthForIndex:function(a,b){var c=0+b,d=a-b,e=a+b,f=this.lastIndex-b;return 2*b>=a?(c=3*b,this.foldRange(c,f)):a>=this.lastIndex-2*b?(f=this.lastIndex-3*b,this.foldRange(c,f)):this.foldRange(c,d).foldRange(e,f)}}),{range:b,rangeBuilder:c}}),angular.module("stPagination").filter("displayPaginationIndex",function(){return function(a){return angular.isNumber(a)?a+1:angular.isArray(a)?"...":a}}),angular.module("stPagination").directive("paginationLimit",["Pagination","$log",function(a){var b=[10,20,50];return{restrict:"E",replace:!0,template:'<select ng-options="limit for limit in limits" ng-model="pagination.$limit"></select>',scope:{collection:"=?",limits:"=?"},link:function(c){c.limits=c.limits||b,c.$watch("collection",function(b){a.hasPagination(b)&&(c.pagination=b.pagination)})}}}]);